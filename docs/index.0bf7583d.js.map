{"mappings":"YAWA,SAAAA,EAAgCC,UACvBA,GAAKA,EAAEC,WAAaD,EAAEE,QAAUF,ECPzC,SAAAG,EAAwBC,EAAW,WACjCA,EAASC,YAAYC,UACdF,EAASG,MAAM,KAAKC,KAAKC,GAASA,EAAKC,OAAO,KAAIC,KAAK,ICJhE,SAAAC,EAAkBC,EAAMC,OACjBV,EAAUW,GAASF,EAAKG,QAAQ,KAAM,IAAIT,MAAM,KAAKC,KAAKC,GAASA,EAAKJ,YAAYC,kBACnFW,EAAWH,EAAQV,OACpBa,eAIDC,EAAgBD,EAASF,MAGzBG,SACMA,EAAcC,MAAM,UAGxBC,EAAcC,WAAWN,MAC/BG,EAAgBD,EAASG,GAGrBF,SACMA,UCjBZ,SAAkBH,SACQ,iBAAVA,IAAuBO,MAAMP,GDmBrCQ,CAAqBH,OAMlBjB,EAAiBC,KAAYW,EAAMS,QAAQ,KAAO,EAAIT,EAAQK,IAAehB,EAAUW,cE/BjF,2/ECKjB,SAAAU,EAAkBC,UACTA,EAAInB,MAAM,MAAMC,KAAIC,GAAQA,EAAKJ,YAAYC,YAAWqB,QAAOlB,GAAQA,IAA+B,IAAvBA,EAAKe,QAAQ,OAAab,KAAK,gBCA/GiB,EAAOC,GACJC,SAASC,eAAeF,GAE3BG,EAAYJ,EAAI,YAoBtBI,EAAUC,iBAAiB,UARV,SAAUC,GACzBA,EAAEC,6BACKC,EAAAA,KAAOC,GAZMC,CAAAA,UACdC,EAAAA,UACND,EAASE,SAAQ,CAACzB,EAAO0B,KAClBF,EAASE,KACZF,EAASE,GAAOH,EAASI,OAAOD,GAAKE,OAAS,EAAIL,EAASI,OAAOD,GAAOH,EAASM,IAAIH,OAGnFF,GAKeM,CAAAA,IAAiBC,SAASC,iBACzCC,EAAAA,QAAUC,GCrBrB,SAAsBD,EAAW,GAAIlC,EAAAA,UAC7BoC,EAAAA,GAOAC,GAJNH,EAAWA,EAAShC,QAAQ,MAAO,IAChCA,QAAQ,MAAO,OACfA,QAAQ,QAAS,OAEMT,MAAM,MAAMC,KAAKK,QCNxBA,CAAAA,KACfA,EAAKW,QAAQ,MAAS,GAGtBX,EAAKW,QAAQ,OAAS,GAGtBX,EAAKW,QAAQ,MAAQ,GAGrBX,EAAKW,QAAQ,MAAQ,KAGlBX,EAAKW,QAAQ,MAAQ,KDLTX,UACRA,QAEFuC,EAAOhD,EAAUW,GAAAA,EAAkBF,EAAMC,UAE3CsC,GAGDhD,IACF8C,EAASE,GAAAA,CAAUhD,EAAUW,UAElBqC,QALJvC,YAeToC,QAPcI,OAAOC,KAAKJ,GAAUK,OAAO/C,KAAKC,UAC1C+C,EAAW/C,EAAKO,QAAQ,MAAO,OAAOA,QAAQ,MAAO,QACpDZ,EAAUW,GAASmC,EAASzC,aACxB+C,KAAYpD,KAAYW,SAIlBJ,KAAK,MACtBqC,SAAUG,EAASxC,KAAK,MAAMK,QAAQ,eAAe,IACrDmC,SAAAA,GDZiBF,CAAwBb,EGnB7C,SAAoBa,EAAU,UACtBQ,EAAAA,OACFC,EAAgB,EAChBC,EAAa,EACbH,EAAW,GACfP,EAAUA,EAAQjC,QAAQ,MAAO,YACxB4C,EAAI,EAAGA,EAAIX,EAAQN,OAAQiB,IAAAA,OAC5BC,EAAWZ,EAAQvC,OAAOkD,MACf,MAAbC,MAKa,MAAbA,EAAa,CACfH,EAAgBE,EAAI,QACdE,EAASb,EAAQc,UAAUJ,EAAYC,GAAGrD,MAAM,MAC/CH,EAAUW,GAAS+C,EAAO,GAAGvD,MAAM,KAAKC,KAAKC,GAASA,EAAKJ,YAAYC,YACzEmD,EAAOrD,KACVqD,EAAOrD,GAAAA,IAETqD,EAAOrD,GAAUW,GAASyC,EAASnD,YAAYC,gBAX/CkD,EAAWP,EAAQc,UAAUL,EAAeE,GAAG5C,QAAQ,MAAO,IAC9D2C,EAAaC,EAAI,SAadH,EHJoCrB,CAAAA,EAA8B,KAAOC,IACxE2B,EAAAA,WDVV,SAAqBC,EAAO,GAAIC,EAAO,UAC/BC,EAAW1C,EAASwC,GACpBG,EAAW3C,EAASyC,UAEtBC,EAGG9C,WAAiD,KAArC8C,EAASxB,OAASyB,EAASzB,QAAgBwB,EAASxB,QAAQ0B,QAAQ,GAF9E,ECKWC,CAAsBlC,EAAOY,EAAWC,aAC1DrB,EAAI,cAAcb,MAAQkC,EAC1BrB,EAAI,eAAeb,MAAAA,GAAWiD,IAAYhB","sources":["./node_modules/@parcel/scope-hoisting/lib/helpers.js","./src/utils/getShortOfProp.js","./src/utils/getSACSS.js","./src/utils/isNumber.js","./node_modules/@parcel/runtime-js/lib/bundles/04230240d0d808e7bf75eebfea9dad60.js","./src/utils/countVolume.js","./src/index.js","./src/utils/processStyle.js","./src/utils/isStyleLine.js","./src/utils/getACSSObj.js"],"sourcesContent":["var $parcel$global =\n  typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof self !== 'undefined'\n    ? self\n    : typeof window !== 'undefined'\n    ? window\n    : typeof global !== 'undefined'\n    ? global\n    : {};\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\nfunction $parcel$defineInteropFlag(a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n}\n\nfunction $parcel$export(e, n, v) {\n  Object.defineProperty(e, n, {get: v, enumerable: true});\n}\n\nfunction $parcel$exportWildcard(dest, source) {\n  Object.keys(source).forEach(function(key) {\n    if (key === 'default' || key === '__esModule') {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function get() {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n}\n\nfunction $parcel$missingModule(name) {\n  var err = new Error(\"Cannot find module '\" + name + \"'\");\n  err.code = 'MODULE_NOT_FOUND';\n  throw err;\n}\n","/**\n * 获取属性的缩写\n * @param propName\n * @returns {string}\n */\nfunction getShortOfProp(propName = '') {\n  propName.trimStart().trimEnd();\n  return propName.split('-').map((item) => item.charAt(0)).join('');\n}\n\nexport default getShortOfProp;\n","import isNumber from \"./isNumber\";\nimport getShortOfProp from \"./getShortOfProp\";\n\nfunction getSACSS(line, objACSS) {\n  let [propName, value] = line.replace(/;/g, '').split(':').map((item) => item.trimStart().trimEnd());\n  const mathProp = objACSS[propName];\n  if (!mathProp) {\n    return [];\n  }\n\n  let matchSelector = mathProp[value];\n\n  // 匹配到了返回\n  if (matchSelector) {\n    return [matchSelector.slice(1)];\n  }\n\n  const numberValue = parseFloat(value);\n  matchSelector = mathProp[numberValue];\n\n  // 匹配到了返回\n  if (matchSelector) {\n    return [matchSelector];\n  }\n\n  const hasNumber = isNumber(numberValue);\n\n  if (!hasNumber) {\n    return [];\n  }\n\n  return [`${getShortOfProp(propName)}${value.indexOf('%') > 0 ? value : numberValue}`, propName, value];\n};\n\nexport default getSACSS;\n","/**\n * 判断是否为数字\n * @param value\n * @returns {boolean}\n */\nfunction isNumber(value) {\n  return typeof value === 'number' && !isNaN(value);\n}\n\nexport default isNumber;\n",null,"/**\n * 过滤\n * @param str\n * @returns {*}\n */\nfunction pureCode(str) {\n  return str.split('\\n').map(item => item.trimStart().trimEnd()).filter(item => item && item.indexOf('*') === -1).join('');\n}\n\n/**\n * 计算体积\n * @param strA\n * @param strB\n * @returns {string}\n */\nfunction countVolume(strA = '', strB = '') {\n  const strPureA = pureCode(strA);\n  const strPureB = pureCode(strB);\n\n  if(!strPureA){\n    return 0;\n  }\n  return parseFloat((strPureA.length - strPureB.length) * 100 / strPureA.length).toFixed(1);\n}\n\nexport default countVolume;\n","import processStyle from \"./utils/processStyle\";\nimport getACSSObj from \"./utils/getACSSObj\";\nimport textSACSS from \"bundle-text:sacss\";\nimport countVolume from \"./utils/countVolume\";\n\n(() => {\n  const $id = (id) => {\n    return document.getElementById(id);\n  };\n  const $FormMain = $id('FormMain');\n\n  const forData2json = (formdata) => {\n    const jsondata = {};\n    formdata.forEach((value, key) => {\n      if (!jsondata[key]) {\n        jsondata[key] = formdata.getAll(key).length > 1 ? formdata.getAll(key) : formdata.get(key);\n      }\n    });\n    return jsondata;\n  }\n\n  const onSubmit = function (e) {\n    e.preventDefault();\n    const {style, acss} = forData2json(new FormData(this));\n    const {strStyle, strACSS} = processStyle(style, getACSSObj(textSACSS + '\\n' + acss));\n    const strAppend =`/* 体积减少 ${countVolume(style, strStyle + strACSS)}% */\\n\\n`;\n    $id('acssOutput').value = strACSS;\n    $id('styleOutput').value = `${strAppend}${strStyle}`;\n  };\n  $FormMain.addEventListener('submit', onSubmit);\n})();\n","import isStyleLine from \"./isStyleLine\";\nimport getSACSS from \"./getSACSS\";\n\nfunction processStyle(strStyle = '', objACSS = {}) {\n  const objStyle = {};\n\n  // 去掉冗余符号\n  strStyle = strStyle.replace(/\\r/g, '')\n    .replace(/\\;/g, ';\\n')\n    .replace(/\\n\\n/g, '\\n');\n\n  const arrStyle = strStyle.split('\\n').map((line) => {\n    // 是否是值所在的行\n    if (!isStyleLine(line)) {\n      return line;\n    }\n    const [sacss, propName, value] = getSACSS(line, objACSS);\n\n    if (!sacss) {\n      return line;\n    }\n    if (propName) {\n      objStyle[sacss] = [propName, value];\n    }\n    return `/* ${sacss} */`;\n  });\n\n  const arrACSS = Object.keys(objStyle).sort().map((item) => {\n    const selector = item.replace(/\\./g, '\\\\.').replace(/\\%/g, '\\\\%');\n    const [propName, value] = objStyle[item];\n    return `.${selector}{${propName}:${value};}`\n  });\n\n  return {\n    strACSS: arrACSS.join('\\n'),\n    strStyle: arrStyle.join('\\n').replace(/ \\*\\/\\n\\/\\*/g,''),\n    arrStyle\n  };\n};\n\nexport default processStyle;\n","/**\n * 判断是否是样式处在的行\n * @param line\n * @returns {boolean}\n */\nconst isStyleLine = (line) => {\n  if (line.indexOf('\\/') > -1) {\n    return false;\n  }\n  if (line.indexOf('\\\\') > -1) {\n    return false;\n  }\n  if (line.indexOf('@') > -1) {\n    return false;\n  }\n  if (line.indexOf('$') > -1) {\n    return false;\n  }\n  return line.indexOf(':') > -1;\n};\n\nexport default isStyleLine;\n","/**\n * 解析 ACSS 字符串\n * @param strACSS\n * @returns {{}}\n */\nfunction getACSSObj(strACSS = '') {\n  const result = {};\n  let indexSelector = 0;\n  let indexValue = 0;\n  let selector = '';\n  strACSS = strACSS.replace(/\\\\/g, '');\n  for (let i = 0; i < strACSS.length; i++) {\n    const thisChar = strACSS.charAt(i);\n    if (thisChar === '{') {\n      selector = strACSS.substring(indexSelector, i).replace(/\\\\/g, '');\n      indexValue = i + 1;\n      continue;\n    }\n    if (thisChar === '}') {\n      indexSelector = i + 1;\n      const values = strACSS.substring(indexValue, i).split(';');\n      const [propName, value] = values[0].split(':').map((item) => item.trimStart().trimEnd());\n      if (!result[propName]) {\n        result[propName] = {};\n      }\n      result[propName][value] = selector.trimStart().trimEnd();\n    }\n  }\n  return result;\n};\nexport default getACSSObj;\n"],"names":["$parcel$interopDefault","a","__esModule","default","$5c1a637ce92118cf3a2fbbdb4788096d$export$default","propName","trimStart","trimEnd","split","map","item","charAt","join","$aaacd07dc412d0aabc2cab32369f4bf1$export$default","line","objACSS","value","replace","mathProp","matchSelector","slice","numberValue","parseFloat","isNaN","hasNumber","indexOf","$f9cca591f2142f991dd987084fd19012$var$pureCode","str","filter","$id","id","document","getElementById","$FormMain","addEventListener","e","preventDefault","style","acss","formdata","jsondata","forEach","key","getAll","length","get","forData2json","FormData","this","strStyle","strACSS","objStyle","arrStyle","sacss","Object","keys","sort","selector","result","indexSelector","indexValue","i","thisChar","values","substring","strAppend","strA","strB","strPureA","strPureB","toFixed","$f9cca591f2142f991dd987084fd19012$export$default"],"version":3,"file":"index.0bf7583d.js.map"}